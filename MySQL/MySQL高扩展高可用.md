### 分区
- 工作原理
  - 分区表是独立的逻辑表，MySQL底层将其分成多个物理子表，每个分区都会有一个独立的表文件
  - 创建表时，使用`partition by`子句定义每个分区存放的数据，执行查询时，优化器会根据分区定义，过滤没有数据的分区
- 适用场景
  - 表非常大，无法全部存在内存，或者只在表的最后有热点数据，其他全是历史数据
  - 分区表的数据更容易维护，可以对独立的分区数据进行独立操作
  - 分区表数据可以分布在不同的机器上
  - 可以避免某些特殊的瓶颈
  - 可以备份和恢复独立的分区
- 限制
  - 一个表只能最多1024个分区
  - 分区字段中如果有主键和唯一索引列，那么都必须包含进来
  - 无法使用外键索引
  - 如果对已存在的表进行分区需要对现有表结构进行修改
  - 所有分区都必须使用相同的存储引擎
  - 分区函数中可以使用的函数和表达式有一些限制
  - 某些存储引擎不支持分区
  - 对于MyISAM的分区表，不能使用`load index into cache`
  - 对于MyISAM使用分区表时需要打开更多的文件描述符

### 分库分表
- 工作原理
  - 通过hash算法或者工具实现一张表进行水平或者垂直的物理切分
- 适用场景
  - 单表记录达到百万到千万级别
  - 解决表锁问题
- 分表方式
  - 水平分割
    - 表很大，分割后降低查询时需要读的数据和索引页数，同时降低索引的层数，提高查询速度
    - 使用场景
      - 表中数据本身就有独立性：比如记录不同地区数据或者有些常用有些不常用
      - 需要将数据存放在多个介质上
    - 缺点
      - 增加复杂度，通常查询需要多个表，查询所有数据需要使用union
      - 复杂度可能会超过带来的优点，查询时会增加读一个索引层的磁盘次数
  - 垂直分表
    - 将主键和一些列放一个表，然后主键和另外的列放在另一个表
    - 使用场景
      - 如果一个表某些列常用，另一些不常用
      - 可以使得数据行变小，一个数据页可以存储更多的数据，查询减少I/O次数
    - 缺点
      - 管理冗余列，查询需要join操作
- 分表缺点
  - 有些分表策略基于应用层逻辑算法，一旦逻辑改变，整个分表逻辑都会变，扩展性差
  - 对应用层，逻辑算法会增加开发成本

### MySQL复制原理与负载均衡
- MySQL主从复制原理
  - 主库把数据更改记录到二进制日志文件
  - 从库将主库的日志文件复制到自己的中继日志
  - 从库再将中继日志的事件读取出来，将其重放到从库数据中
- 解决的问题
  - 数据分布：随意停止或开始复制，并在不同位置分布数据备份
  - 负载均衡：降低单个数据库服务器压力
  - 高可用和故障切换：帮助应用程序避免单点失败
  - 升级测试：可以使用更高版本的MySQL作为从库
